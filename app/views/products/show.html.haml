.b-product
  %h3= resource.title

  = render 'products/includes/image_gallery_show_product_page', resource: resource if resource.photos.any?

  .b-product-short-info
    = price_with_discount(resource)
    .ratable.read_only{ data: { score: resource.average_score } }
    = link_to [resource.published_reviews_count, t('views.product.reviews_count', count: resource.published_reviews_count)].join(' '), '#', class: 'reviews-count'

    = render 'products/includes/stores', stores: @stores if @stores.present?

  .b-product-description
    %h4 О товаре
    %p= raw resource.description

  = render 'products/includes/characteristics', characteristics: @characteristics if @characteristics.present?

  %h3= "Отзывы (#{ resource.published_reviews_count })"

  - if current_user.present? && resource.can_vote?(current_user.id)
    %h4 Ваш отзыв
    .rating
      %p Рейтинг
      %p.ratable

    = form_for(Review.new, url: [:add_review, resource], method: :post) do |f|
      = hidden_field_tag 'review[rating_score]'
      = f.hidden_field :user_id, { value: current_user.id }
      %p
        = f.label :pluses, t('pluses', scope: [:activerecord, :attributes, :review])
        = f.text_field :pluses

      %p
        = f.label :cons, t('cons', scope: [:activerecord, :attributes, :review])
        = f.text_field :cons

      %p
        = f.label :body, t('body', scope: [:activerecord, :attributes, :review])
        = f.text_field :body

      %p= f.submit 'Оставить отзыв'

  - if @related_products.present?
    %h4 Товары в комплект
    %ol
      - @related_products.each do |related|
        %li= related.title

  - if @similar_products.present?
    %h4 Вам может понравиться
    %ol
      - @similar_products.each do |similar|
        %li= similar.title
